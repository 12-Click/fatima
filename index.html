<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>360-Degree AR Storytelling Experience</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/KhronosGroup/AR.js/master/aframe/build/aframe-ar.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: #000;
        }

        a-scene {
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>
    <a-scene embedded arjs='sourceType: webcam;'>
        <a-entity 
            id="model"
            gltf-model="url(assets/fatima1.glb)" 
            scale="0.5 0.5 0.5"
            position="0 0 -2"
            rotation="0 0 0"
            draggable
            animation-mixer>
        </a-entity>
        <a-entity camera></a-entity>
    </a-scene>

    <script>
        AFRAME.registerComponent('draggable', {
            init: function () {
                this.el.addEventListener('mousedown', this.onMouseDown.bind(this));
                this.el.addEventListener('touchstart', this.onMouseDown.bind(this));
            },

            onMouseDown: function (evt) {
                this.el.setAttribute('dragging', true);
                this.lastMouseX = evt.clientX || evt.touches[0].clientX;
                this.lastMouseY = evt.clientY || evt.touches[0].clientY;

                document.addEventListener('mousemove', this.onMouseMove.bind(this));
                document.addEventListener('touchmove', this.onMouseMove.bind(this));
                document.addEventListener('mouseup', this.onMouseUp.bind(this));
                document.addEventListener('touchend', this.onMouseUp.bind(this));
            },

            onMouseMove: function (evt) {
                if (this.el.getAttribute('dragging')) {
                    const deltaX = (evt.clientX || evt.touches[0].clientX) - this.lastMouseX;
                    const deltaY = (evt.clientY || evt.touches[0].clientY) - this.lastMouseY;

                    const rotation = this.el.getAttribute('rotation');
                    rotation.y += deltaX * 0.1; // Rotate on Y-axis
                    rotation.x -= deltaY * 0.1; // Rotate on X-axis

                    this.el.setAttribute('rotation', rotation);

                    this.lastMouseX = evt.clientX || evt.touches[0].clientX;
                    this.lastMouseY = evt.clientY || evt.touches[0].clientY;
                }
            },

            onMouseUp: function () {
                this.el.setAttribute('dragging', false);
                document.removeEventListener('mousemove', this.onMouseMove.bind(this));
                document.removeEventListener('touchmove', this.onMouseMove.bind(this));
                document.removeEventListener('mouseup', this.onMouseUp.bind(this));
                document.removeEventListener('touchend', this.onMouseUp.bind(this));
            }
        });
    </script>
</body>
</html>
